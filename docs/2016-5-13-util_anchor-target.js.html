---

layout: post
title: "util/anchor-target.js"
author: Admin
categories:

---


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';
var dl = require('datalib'),
    sg = require('../model/signals');

/**
 * Returns a Vega expression string that tests whether the anchor target has a
 * particular key or is a scenegraph item itself.
 *
 * @param {Object} mark - A Mark object.
 * @param {string} mode - The Lyra manipulator mode.
 * @param {string} [key] - The key of a specific manipulator instance.
 * @returns {string} A Vega expression string.
 */
module.exports = function(mark, mode, key) {
  // sg is required here to prevent a circular reference
  var ANCHOR = sg.ANCHOR,
      TARGET = ANCHOR + '.target',
      expr = '(' + ANCHOR + '&amp;&amp;' + TARGET + '&amp;&amp;' + TARGET + '.datum &amp;&amp;';

  if (key) {
    // Manipulator
    expr += TARGET + '.datum.mode === ' + dl.str(mode) + ' &amp;&amp;' +
      TARGET + '.datum.lyra_id === ' + dl.str(mark._id) + '&amp;&amp;' +
      'test(regexp(' + dl.str(key) + ', "i"), ' + TARGET + '.datum.key)';
  } else {
    // Mark
    expr += TARGET + '.mark &amp;&amp; ' + TARGET + '.mark.name === ' + dl.str(mark.name);
  }
  return expr + ')';
};
</code></pre>
        </article>
    </section>




<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Thu May 12 2016 11:01:08 GMT-0700 (PDT) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>



