!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.lyra=e()}}(function(){var e;return function t(e,n,r){function o(u,s){if(!n[u]){if(!e[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(i)return i(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[u]={exports:{}};e[u][0].call(f.exports,function(t){var n=e[u][1][t];return o(n?n:t)},f,f.exports,t,e,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){function r(){f=!1,s.length?l=s.concat(l):c=-1,l.length&&o()}function o(){if(!f){var e=setTimeout(r);f=!0;for(var t=l.length;t;){for(s=l,l=[];++c<t;)s&&s[c].run();c=-1,t=l.length}s=null,f=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function u(){}var s,a=t.exports={},l=[],f=!1,c=-1;a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new i(e,t)),1!==l.length||f||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=u,a.addListener=u,a.once=u,a.off=u,a.removeListener=u,a.removeAllListeners=u,a.emit=u,a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],2:[function(t,n,r){(function(r,o){(function(){"use strict";function i(e){return"function"==typeof e||"object"==typeof e&&null!==e}function u(e){return"function"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){K=e}function l(e){Q=e}function f(){return function(){r.nextTick(y)}}function c(){return function(){Y(y)}}function p(){var e=0,t=new $(y),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function d(){var e=new MessageChannel;return e.port1.onmessage=y,function(){e.port2.postMessage(0)}}function h(){return function(){setTimeout(y,1)}}function y(){for(var e=0;J>e;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}J=0}function v(){try{var e=t,n=e("vertx");return Y=n.runOnLoop||n.runOnContext,c()}catch(r){return h()}}function w(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function _(e){try{return e.then}catch(t){return ue.error=t,ue}}function b(e,t,n,r){try{e.call(t,n,r)}catch(o){return o}}function x(e,t,n){Q(function(e){var r=!1,o=b(n,t,function(n){r||(r=!0,t!==n?j(e,n):O(e,n))},function(t){r||(r=!0,M(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,M(e,o))},e)}function k(e,t){t._state===oe?O(e,t._result):t._state===ie?M(e,t._result):T(t,void 0,function(t){j(e,t)},function(t){M(e,t)})}function A(e,t){if(t.constructor===e.constructor)k(e,t);else{var n=_(t);n===ue?M(e,ue.error):void 0===n?O(e,t):u(n)?x(e,t,n):O(e,t)}}function j(e,t){e===t?M(e,m()):i(t)?A(e,t):O(e,t)}function E(e){e._onerror&&e._onerror(e._result),S(e)}function O(e,t){e._state===re&&(e._result=t,e._state=oe,0!==e._subscribers.length&&Q(S,e))}function M(e,t){e._state===re&&(e._state=ie,e._result=t,Q(E,e))}function T(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+oe]=n,o[i+ie]=r,0===i&&e._state&&Q(S,e)}function S(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,o,i=e._result,u=0;u<t.length;u+=3)r=t[u],o=t[u+n],r?P(n,r,o,i):o(i);e._subscribers.length=0}}function C(){this.error=null}function z(e,t){try{return e(t)}catch(n){return se.error=n,se}}function P(e,t,n,r){var o,i,s,a,l=u(n);if(l){if(o=z(n,r),o===se?(a=!0,i=o.error,o=null):s=!0,t===o)return void M(t,g())}else o=r,s=!0;t._state!==re||(l&&s?j(t,o):a?M(t,i):e===oe?O(t,o):e===ie&&M(t,o))}function I(e,t){try{t(function(t){j(e,t)},function(t){M(e,t)})}catch(n){M(e,n)}}function L(e,t){var n=this;n._instanceConstructor=e,n.promise=new e(w),n._validateInput(t)?(n._input=t,n.length=t.length,n._remaining=t.length,n._init(),0===n.length?O(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&O(n.promise,n._result))):M(n.promise,n._validationError())}function R(e){return new ae(this,e).promise}function D(e){function t(e){j(o,e)}function n(e){M(o,e)}var r=this,o=new r(w);if(!H(e))return M(o,new TypeError("You must pass an array to race.")),o;for(var i=e.length,u=0;o._state===re&&i>u;u++)T(r.resolve(e[u]),void 0,t,n);return o}function q(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(w);return j(n,e),n}function N(e){var t=this,n=new t(w);return M(n,e),n}function W(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function G(e){this._id=de++,this._state=void 0,this._result=void 0,this._subscribers=[],w!==e&&(u(e)||W(),this instanceof G||F(),I(this,e))}function U(){var e;if("undefined"!=typeof o)e=o;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(e.Promise=he)}var V;V=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var Y,K,B,H=V,J=0,Q=({}.toString,function(e,t){ne[J]=e,ne[J+1]=t,J+=2,2===J&&(K?K(y):B())}),X="undefined"!=typeof window?window:void 0,Z=X||{},$=Z.MutationObserver||Z.WebKitMutationObserver,ee="undefined"!=typeof r&&"[object process]"==={}.toString.call(r),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3);B=ee?f():$?p():te?d():void 0===X&&"function"==typeof t?v():h();var re=void 0,oe=1,ie=2,ue=new C,se=new C;L.prototype._validateInput=function(e){return H(e)},L.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},L.prototype._init=function(){this._result=new Array(this.length)};var ae=L;L.prototype._enumerate=function(){for(var e=this,t=e.length,n=e.promise,r=e._input,o=0;n._state===re&&t>o;o++)e._eachEntry(r[o],o)},L.prototype._eachEntry=function(e,t){var n=this,r=n._instanceConstructor;s(e)?e.constructor===r&&e._state!==re?(e._onerror=null,n._settledAt(e._state,t,e._result)):n._willSettleAt(r.resolve(e),t):(n._remaining--,n._result[t]=e)},L.prototype._settledAt=function(e,t,n){var r=this,o=r.promise;o._state===re&&(r._remaining--,e===ie?M(o,n):r._result[t]=n),0===r._remaining&&O(o,r._result)},L.prototype._willSettleAt=function(e,t){var n=this;T(e,void 0,function(e){n._settledAt(oe,t,e)},function(e){n._settledAt(ie,t,e)})};var le=R,fe=D,ce=q,pe=N,de=0,he=G;G.all=le,G.race=fe,G.resolve=ce,G.reject=pe,G._setScheduler=a,G._setAsap=l,G._asap=Q,G.prototype={constructor:G,then:function(e,t){var n=this,r=n._state;if(r===oe&&!e||r===ie&&!t)return this;var o=new this.constructor(w),i=n._result;if(r){var u=arguments[r-1];Q(function(){P(r,o,u,i)})}else T(n,o,e,t);return o},"catch":function(e){return this.then(null,e)}};var ye=U,ve={Promise:he,polyfill:ye};"function"==typeof e&&e.amd?e(function(){return ve}):"undefined"!=typeof n&&n.exports?n.exports=ve:"undefined"!=typeof this&&(this.ES6Promise=ve),ye()}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:1}],3:[function(e,t,n){(function(n){function r(){var e=u.manipulators();o.parse.spec(e,function(e){s.view=e({el:"#vis"}).update()})}e("es6-promise").polyfill();var o=("undefined"!=typeof window?window.d3:"undefined"!=typeof n?n.d3:null,"undefined"!=typeof window?window.vg:"undefined"!=typeof n?n.vg:null),i=e("./schema"),u=new(e("../vis/Visualization")),s=null;t.exports=s={Vis:u,schema:i,render:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../vis/Visualization":5,"./schema":4,"es6-promise":2}],4:[function(e,t,n){(function(e){var n="undefined"!=typeof window?window.vg:"undefined"!=typeof e?e.vg:null,r=null;t.exports=function(){return r||(r=n.schema({url:"http://vega.github.io/vega/vega-schema.json"}))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){(function(n){function r(){o.call(this),this.width=500,this.height=500,this.padding="auto"}var o=("undefined"!=typeof window?window.vg:"undefined"!=typeof n?n.vg:null,e("./primitives/marks/Group")),i=r.prototype=Object.create(o.prototype);i.constructor=r,i["export"]=function(){var e=o.prototype["export"].call(this);return delete e.type,delete e.from,delete e.properties,e},i.manipulators=function(){var e=o.prototype.manipulators.call(this).marks[0],t=e.signals||(e.signals=[]);return t.push.apply(t,[{name:"lyra.selected",init:null,streams:[{type:"click[eventItem().mark.name]",expr:"eventItem()"}]},{name:"lyra.manipulators",init:"handles"}]),e},t.exports=r,r.manipulators=e("./manipulators")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./manipulators":8,"./primitives/marks/Group":10}],6:[function(e,t,n){(function(e){function n(e){return s.prototype.init.call(this,e),s.addParameters(this,{name:{type:"value"},kind:{type:"value"}}),this._cacheID=null,this._cache=[],this.router(!0).produces(!0).dependency(u.SIGNALS,["lyra.selected","lyra.manipulators"])}var r="undefined"!=typeof window?window.vg:"undefined"!=typeof e?e.vg:null,o=r.dataflow,i=o.ChangeSet,u=o.Dependencies,s=r.transforms.Transform,a=n.prototype=Object.create(s.prototype);a.constructor=n,a.transform=function(e){function t(t){var r,i,u,s=e[t],f=l[t];for(i=0,u=s.length,r;u>i;++i)if(r=s[i],!o||r._id===o._id)return n._cacheID=r._id,n._cache=n[a](r),f.push.apply(f,n._cache),!0;return!1}var n=this,r=this._graph,o=r.signal("lyra.selected").value(),u=r.signal("lyra.manipulators").value(),s=this.param("name"),a=this.param("kind"),l=i.create(e);return o&&this._cacheID!==o._id&&this._cache.length&&l.rem.push(this._cache.splice(0)),o&&s!==o.mark.name||a!==u?l:t("add")?l:(t("mod"),l)},a.handles=function(e){return[]},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t,n){(function(n){function r(e){return u.call(this,e)}function o(e){var t=e.bounds;return{topLeft:{x:t.x1,y:t.y1,cursor:"nw-resize"},topCenter:{x:t.x1+t.width()/2,y:t.y1,cursor:"n-resize"},topRight:{x:t.x2,y:t.y1,cursor:"ne-resize"},midLeft:{x:t.x1,y:t.y1+t.height()/2,cursor:"w-resize"},midCenter:{x:t.x1+t.width()/2,y:t.y1+t.height()/2,cursor:"move"},midRight:{x:t.x2,y:t.y1+t.height()/2,cursor:"e-resize"},bottomLeft:{x:t.x1,y:t.y2,cursor:"sw-resize"},bottomCenter:{x:t.x1+t.width()/2,y:t.y2,cursor:"s-resize"},bottomRIght:{x:t.x2,y:t.y2,cursor:"se-resize"}}}var i="undefined"!=typeof window?window.vg:"undefined"!=typeof n?n.vg:null,u=e("./Manipulators"),s=r.prototype=Object.create(u.prototype);s.constructor=r,s.handles=function(e){var t=o(e);return delete t.midCenter,i.util.vals(t)},i.transforms["lyra.Manipulators.rect"]=r,t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Manipulators":6}],8:[function(e,t,n){t.exports={Rect:e("./Rect")}},{"./Rect":7}],9:[function(e,t,n){(function(e){function n(){}function r(e){var t,n,i;for(t in e)n=e[t],i=t.startsWith("_"),i=i||n._disabled,i?delete e[t]:o.isObject(n)&&(e[t]=r(e[t]));return e}var o="undefined"!=typeof window?window.vg.util:"undefined"!=typeof e?e.vg.util:null,i=("undefined"!=typeof window?window.vg:"undefined"!=typeof e?e.vg:null,n.prototype);i["export"]=function(){return r(o.duplicate(this))},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t,n){(function(n){function r(){u.call(this,"group"),this.scales=[],this.legends=[],this.axes=[],this.marks=[]}function o(e){return e["export"]()}function i(e){return e.manipulators()}var u=("undefined"!=typeof window?window.vg:"undefined"!=typeof n?n.vg:null,e("./Mark")),s=["scales","axes","legends","marks"],a=["rect","symbol","arc","area","line","text"],l={rect:e("./Rect")},f=r.prototype=Object.create(u.prototype);f.constructor=r,f["export"]=function(){var e=this,t=u.prototype["export"].call(this);return s.forEach(function(n){t[n]=e[n].map(o)}),t},f.manipulators=function(){var e=this,t=u.prototype.manipulators.call(this),n=t.marks[0];return s.forEach(function(t){n[t]=e[t].map(i)}),t},f.child=function(e){var t=new l[e](e);return a.indexOf(e)>=0?this.marks.push(t):this[e].push(t),t},t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Mark":11,"./Rect":12}],11:[function(e,t,n){function r(e){return this.name=e+"_"+ ++i,this.type=e,this.from={},this.properties={enter:{x:{value:25},y:{value:25},fill:{value:"#4682b4"},fillOpacity:{value:1},stroke:{value:"#000000"},strokeWidth:{value:.25}}},this}var o=e("../Primitive"),i=0,u=r.prototype=Object.create(o.prototype);u.constructor=r;var s=[{kind:"handles",properties:{enter:{shape:{value:"square"},stroke:{value:"black"},strokeWidth:{value:.5}},update:{x:{field:"x"},y:{field:"y"},size:{value:40},fill:{value:"white"}}}}];u.manipulators=function(){var e=this,t=[this["export"]()].concat(s.map(function(t){return{type:"symbol",from:{mark:e.name,transform:[{type:"lyra.Manipulators."+e.type,name:e.name,kind:t.kind}]},properties:t.properties}}));return{type:"group",properties:{enter:{x:{value:0},y:{value:0},width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:t}},t.exports=r},{"../Primitive":9}],12:[function(e,t,n){(function(n){function r(e){i.call(this,"rect");var t=this.properties,n=t.enter;return o.extend(n,{width:{value:30},x2:{value:0,_disabled:!0},height:{value:30},y2:{value:0,_disabled:!0}}),this}var o="undefined"!=typeof window?window.vg.util:"undefined"!=typeof n?n.vg.util:null,i=e("./Mark"),u=r.prototype=Object.create(i.prototype);u.constructor=r,t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Mark":11}]},{},[3])(3)});
